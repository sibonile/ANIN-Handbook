{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"ANIN Drought Indices Handbook","text":""},{"location":"#introduction","title":"Introduction","text":"<p>Welcome to the handbook for the ANIN South Africa Drought Monitoring Project. This project is part of the EO Africa initiative, funded by the European Space Agency (ESA), aimed at enhancing the capacity of South African stakeholders to manage drought risks through advanced Earth Observation (EO) technologies. The primary objective of this project is to develop and implement innovative drought indices tools that provide timely and accurate information to support decision-making processes.</p>"},{"location":"#objectives","title":"Objectives","text":"<ol> <li>Enhance Drought Monitoring: Develop robust drought indices that utilize EO data to provide real-time monitoring and assessment of drought conditions.</li> <li>Support Decision-Making: Equip stakeholders with reliable tools and information to make informed decisions regarding drought management and response.</li> <li>Capacity Building: Train local authorities and organizations in the use of EO-based drought indices tools, fostering self-reliance and sustainability.</li> <li>Promote Collaboration: Facilitate partnerships between African institutions, international organizations, and the scientific community to advance drought resilience efforts.</li> </ol>"},{"location":"#acknowledgements","title":"Acknowledgements","text":"<p>The tools presented in this handbook were created as a result of a collaborative effort by the members of a consortium whose members include:</p>"},{"location":"#funding-and-sponsorship","title":"Funding and Sponsorship","text":"<p>The European Space Agency (ESA) created the EO Africa initiative (African Framework for Research, Innovation, Communities and Applications) to build an African-European R&amp;D partnership to facilitate the sustainable adoption of Earth Observation and related space technology in Africa. This project is one of the four EO AFRICA' National Incubators' projects that investigate how sustainable agriculture and/or drought monitoring at a national scale can be achieved in the African continent by co-developing innovative EO-based solutions with African experts. </p> <p></p> <p>For more information on the ANIN South Africa Drought Monitoring Project, visit https://eoafrica.drought-za.org/.</p>"},{"location":"FAQ_Python/","title":"Frequently Asked Questions (FAQ)","text":""},{"location":"FAQ_Python/#why-do-we-work-in-a-virtual-environment","title":"Why do we work in a virtual environment?","text":"<p>A virtual environment is a dedicated space on your computer for this project. It helps manage all the necessary tools and packages for the ANIN drought algorithms without interfering with other projects or programs on your system. Using a virtual environment prevents conflicts between different versions of Python or packages, ensuring that the project runs smoothly and consistently.</p>"},{"location":"FAQ_Python/#how-do-i-find-the-location-of-my-python-installation","title":"How do I find the location of my Python installation?","text":"<p>Open a separate Command Prompt window by pressing <code>Win + R</code>, type <code>cmd</code>, and press <code>Enter</code>. Then, run the following command: <pre><code>where python\n</code></pre> This command will list all installed Python paths, which may look like this:</p> <p><pre><code>C:\\Python27\\python.exe\nC:\\Users\\&lt;YourUsername&gt;\\AppData\\Local\\Programs\\Python\\Python38\\python.exe\nC:\\Users\\&lt;YourUsername&gt;\\.pyenv\\pyenv-win\\shims\\python\nC:\\Users\\&lt;YourUsername&gt;\\AppData\\Local\\Programs\\Python\\Python312\\python.exe\n</code></pre> To copy the path of the latest Python version (e.g., Python312), right-click in the Command Prompt window, select <code>Mark</code>, highlight the path, and then right-click again to copy the highlighted text to your clipboard.</p>"},{"location":"FAQ_Python/#how-often-to-i-need-to-activate-the-virtual-environment","title":"How often to I need to activate the virtual environment?","text":"<p>You need to activate the virtual environment every time you start a new session or open your terminal to work on the ANIN drought algorithms. Activating the virtual environment is crucial because it isolates the specific tools, libraries, and Python version required for the project.</p> <p>If the virtual environment is not activated, your system will use the global Python installation and packages, which might not be compatible with the project's requirements. Activating the virtual environment ensures that you are using the correct setup, preventing issues such as version conflicts or missing dependencies.</p>"},{"location":"Installation/","title":"Installation","text":""},{"location":"Installation/#requirements","title":"Requirements","text":"<p>To run the Drought Indices tools, a recent version of Python needs to be installed on your system\u2014first, visit Python.org to confirm the latest version number. </p> <p>You can check the version of Python you have installed by pressing <code>Win + R</code>, type <code>cmd</code>, and press <code>Enter</code> to open Command Prompt then running the command below.  <pre><code>python --version\n</code></pre> Please ensure that version 3.8 or higher is installed before proceeding. </p>"},{"location":"Installation/#installing-python","title":"Installing Python","text":"<p>Install Python by downloading an installer appropriate to your system from python.org  and running it.</p> <p>Be sure to check the box to have Python added to your PATH.</p> <p></p>"},{"location":"Installation/#installing-git-on-windows","title":"Installing Git on Windows","text":"<ol> <li>Navigate to the latest Git for Windows installer  and download the latest version.</li> <li>Follow the instructions as provided in the Git Setup wizard screen until the installation is complete. When prompted, select use standard Git Windows Command Prompt.</li> <li>Verify that Git was properly installed by running the following in <code>Command Prompt</code>.</li> </ol> <pre><code> git version\n</code></pre> <p>Other Operating Systems</p> <p>If you are running other operating systems such as macOS, Linux, Ubuntu, etc, please follow the installation steps:</p> <p>For Python visit: Download Python for Other Platforms </p> <p>For Git visit: Install Git for Other Platforms</p>"},{"location":"Installation/#clone-the-anin-drought-indices-repository","title":"Clone the ANIN drought indices repository","text":"<p>Open a Command Prompt or a terminal and change the directory to the folder where you will be working. As an example, if you are working from a drive labelled <code>*K*</code> in the folder located at this directory address <code>K:\\DroughtIndices</code>, the following prompt will change the directory.</p> <p><pre><code>k:\n</code></pre> <pre><code>cd k:\\DroughtIndices\n</code></pre></p> <p>Now that you are in your working folder, you can clone the ANIN drought indices repository using the following prompt: <pre><code>git clone https://github.com/VitoTAP/ANIN-drought-indices\n</code></pre> All the files in the ANIN Drought Indices repository will be cloned to your local machine in your specified working folder. You can easily verify that in Windows Explorer. </p> <p></p> <p>In Command Prompt, change the directory again to point to the newly created <code>ANIN-drought-indices</code> folder on your PC using the following prompt: <pre><code>cd \\ANIN-drought-indices\n</code></pre></p>"},{"location":"Installation/#create-a-virtual-environment-with-python","title":"Create a Virtual Environment with Python","text":"<p>Users with software dependent on older Python versions, like ArcGIS, may encounter issues in Command Prompt. To avoid conflicts when running ANIN tools, create a virtual environment in your working folder by executing the following commands:</p> <pre><code>python -m venv venv\n</code></pre> <p>Tip</p> <p>If you encounter an error when creating the virtual environment, Command Prompt might be calling an older version of Python. To fix this, modify the command to point to the latest version by replacing <code>python</code> with the full path to the <code>python.exe</code> file from your recent installation. It should look like this: <pre><code>path/to/where/python/is/installed/python.exe -m venv venv\n</code></pre> To find the location of the latest Python follow these steps</p> <p>Once the virtual environment is created, we can activate it. <pre><code>venv\\Scripts\\activate.bat\n</code></pre></p> <p>Note</p> <p>You will need to activate the virtual environment each time you restart a session in Command Prompt. When the virtual environment is activated, you will see (venv) in front of the directory.</p>"},{"location":"Installation/#install-pip-and-other-requirements","title":"Install pip and other requirements","text":"<p>We can now install pip and the other requirements to run the ANIN drought indices tools.</p> <p><pre><code>python -m pip install -r requirements.txt\n</code></pre> Now that all the installations are complete, we can start running the different drought indices tools.</p>"},{"location":"JupyterNB/","title":"Running Drought Indices from Jupyter Notebooks","text":"<p>Here is a simple workflow using examples, locations and dates that will aid you in accessing the ANIN drought indices through Jupyter Notebook. After completing the steps below, you should be able to adjust the location with your coordinates and date ranges where applicable.</p> <p>The steps described below should be completed after the initial Installation.</p>"},{"location":"JupyterNB/#install-jupyterlab-and-notebook","title":"Install Jupyterlab and Notebook","text":"<p>Use the following Python prompts to install Jupyterlab and Notebook. <pre><code>pip install jupyterlab\n</code></pre> <pre><code>pip install notebook\n</code></pre></p>"},{"location":"JupyterNB/#launch-jupyter-notebook","title":"Launch Jupyter Notebook","text":"<ol> <li>Open Windows Explorer and navigate to the folder where the ANIN-drought-indices folder is cloned.</li> <li>Click on the Address bar and copy the address.</li> <li>Type CMD in the address bar and hit Enter. This will launch the Command Prompt.</li> <li>In the Command Prompt window, enter the following code: <pre><code>jupyter notebook\n</code></pre> This will open Jupyter Notebook in your default browser.</li> </ol>"},{"location":"JupyterNB/#setup-and-testing","title":"Setup and Testing","text":"<p>Double-click <code>setup_and_test.ipynb</code> on the home page. It will open in a new tab and require you to 'Restart the kernel and run all cells (under <code>Run</code> in the menu). Jupyter Notebook will install all the requirements to run the code, followed by a sample test query, which requests a Sentinel-2 image over The Innovation Hub in Pretoria, South Africa.</p> <p></p>"},{"location":"JupyterNB/#edit-the-spatial-and-temporal-extent","title":"Edit the spatial and temporal extent","text":"<p>Within the code block, you can change the location to that of your choosing and adjust the date range for the image search and the name of the output file by changing the values in the highlighted lines shown below.</p> <pre><code>import openeo\nfrom openeo.processes import process\n\nurl = \"https://openeo.cloud\"\nconnection = openeo.connect(url).authenticate_oidc()\n\nspatial_extent_sansa = {\n    \"east\": 28.275,\n    \"north\": -25.740,\n    \"south\": -25.755,\n    \"west\": 28.260,\n}\n\ndatacube = connection.load_collection(\n    collection_id=\"SENTINEL2_L2A\",\n    bands=[\"B04\", \"B03\", \"B02\"],\n    spatial_extent=spatial_extent_sansa,\n    temporal_extent=[\"2024-03-05\", \"2024-03-07\"],\n)\n# Scale values for better visualisation\ndatacube = datacube / 2500\n\ndatacube.download(\"out-Pretoria.tiff\")\n</code></pre>"},{"location":"JupyterNB/#run-standardised-precipitation-index-spi","title":"Run Standardised Precipitation Index (SPI)","text":"<p>In the SPI folder, you will find <code>SPI_openeo.ipynb</code>. Double-click on it to open it in a new tab. This index will return results for the whole country with results previews provided.</p> <p> </p> <p>The code block provides you the option to adjust the temporal extent by adjusting the highlighted line of code:</p> <pre><code>dc = SPI_dc\ndc = dc.filter_temporal([\"2022-01-01\", \"2022-06-01\"])\n# out_format = \"NetCDF\"\nout_format = \"GTiff\"\ndc = dc.save_result(format=out_format)\noutput_path = custom_execute_batch(dc, job_options=heavy_job_options, out_format=out_format)\n</code></pre>"},{"location":"JupyterNB/#run-soil-moisture-anomaly-sma","title":"Run Soil Moisture Anomaly (SMA)","text":"<p>From the Jupyter Home page, open the SMA folder and double-click <code>SMA_openeo.ipynb</code> to open the notebook. It will open in another tab. As will the startup, Restart the kernel and run all cells. Should you encounter a request to authenticate your account, follow the link to the EGI login website and log in.  Return to the SMA notebook to view the results.</p> <p>Tip</p> <p>The script will create the output TIFFs in folders labelled <code>out-xxx</code> in the respective folders, which can be visualised in any GIS software.</p>"},{"location":"OpenEO/","title":"Frequently Asked Questions (FAQ)","text":""},{"location":"OpenEO/#wherehow-do-i-create-an-openeo-account","title":"Where/How do I create an OpenEO account?","text":"<p>To run the ANIN drought indices algorithms, you'll need access to the OpenEO cloud platform. Follow these steps to create an account:</p> <p>Visit the EGI Check-in Page: Start by navigating to the EGI Check-in page. </p> <p></p> <p>Sign Up: On the EGI Check-in page, you can sign up using your social accounts such as Google, LinkedIn, or GitHub. Choose your preferred social account and follow the on-screen instructions to set up your account.</p> <p>Register with Work Email: If you prefer to use your work email, click on the Can't find your identity provider? link at the bottom of the page. Follow the instructions to create an EGI SSO account. You\u2019ll receive an email with instructions to complete the setup.</p> <p>Log In to Terrascope Portal: After setting up your account, go to the Terrascope portal and <code>SIGN IN</code> using <code>EduGAIN &amp; social logins</code> with the credentials you created.</p> <p> </p> <p>Grant Access: When prompted, click <code>Yes</code> to grant access to Terrascope. Complete the required information on the intake form to finalize your registration.</p>"},{"location":"OpenEO/#im-having-trouble-setting-up-my-account-what-should-i-do","title":"I'm having trouble setting up my account. What should I do?","text":"<p>If you encounter any issues while setting up your account, please email checkin-support@mailman.egi.eu for further assistance. </p>"},{"location":"drought_indices/","title":"Running the Drought Indices Tools","text":""},{"location":"drought_indices/#general-overview","title":"General Overview","text":"<p>All the tools developed in this project can be deployed and executed using Command Prompt, Jupyter Notebooks, or Docker. This section of the Handbook follows the previous section and presents a simple workflow for computing the drought indices from Command Prompt. For a more detailed explanation of each index, it's use and application, see the Specifications. </p> <p>Before your proceed</p> <ol> <li>Make sure have created and activated the Python Virtual Environment.</li> <li>Make sure you have an active OpenEO account.</li> </ol> <p>The table below shows the drought indices and their corresponding Python prompt.  Please note that with CDI you must define a temporal extent.</p> Index Command Requirements Soil Moisture Anomaly (SMA) <code>python -m SMA.SMA_openeo</code> None Standardised Precipitation Index (SPI) <code>python -m SPI.SPI_openeo</code> None Standardised Precipitation-Evapotranspiration Index (SPEI) <code>python -m SPEI.SPEI_openeo</code> None FAPAR Anomaly <code>python -m FAPAR_Anomaly.FAPAR_Anomaly_openeo</code> None Vegetation Condition Index (VCI) <code>python -m VCI.VCI_openeo</code> None Combined Drought Indicator (CDI) <code>python -m CDI.CDI_openeo</code> Temporal extent"},{"location":"drought_indices/#example-1-standardised-precipitation-index-spi","title":"Example 1: Standardised Precipitation Index (SPI)","text":"<p>The SPI tool provides monthly time-series information based on precipitation data. It is computed at a national scale at a resolution of 1\u00b0 x 1\u00b0 and requires no temporal extent as an input. To run SPI, input the Python code below into the command prompt. <pre><code>python -m SPI.SPI_openeo\n</code></pre> The script will create the output TIFFs in folders labelled <code>out-xxx</code> in the SPI folder, which can be visualised in any GIS software.</p> <p></p> <p>Authentification Error</p> <p>The first time you run the command, you may be prompted to authenticate via the EGI website.</p> <p>  Simply copy the provided URL (CTRL +M) as seen above, paste it into your browser, and follow the authentication steps using your OpenEO account credentials. When prompted select <code>Yes</code> to <code>Grant Access to openEO Platform</code></p>"},{"location":"drought_indices/#example-2-combined-drought-indicator-cdi","title":"Example 2: Combined Drought Indicator (CDI)","text":"<p>The CDI tool provides near-monthly time-series information based on Standardised Precipitation Index (SPI), Soil Moisture Anomaly (SMA) and FAPAR anomaly, resulting in maps that can be used for drought watch, warning and alert. This tool does require a temporal extent for performance. To run CDI, input the Python code below into the command prompt. In this example, we use June to December 2022 as our temporal extent. <pre><code>python -m CDI.CDI_openeo \"2022-06-01\" \"2022-12-01\"\n</code></pre> As with Example 1, an <code>out-xxx</code> folder will be created in the CDI folder, which contains six TIFFs, as shown below. These can be visualised in any GIS software.</p> <p> </p>"},{"location":"drought_indices/#export-to-csv-format","title":"Export to CSV format","text":"<p>The default output format for the Drought Indices Python code is TIFF. If you prefer to receive the output in CSV format, simply append the <code>--out_format=CSV</code> option to the end of any command listed in the table above. For example, you would use the following command to get SMA in CSV format.  <pre><code>python -m SMA.SMA_openeo --out_format=CSV\n</code></pre></p> <p>Note</p> <p>The CSV output contains data aggregated as an average at the secondary catchment level.</p>"},{"location":"examples/","title":"Example Results","text":"<p>If you would like to view example outputs from the drought indices presented in this handbook, we have generated samples and saved them on Artifactory for your convenience. You can access them using the links provided in the table below. </p>"},{"location":"examples/#sample-tiffs","title":"Sample TIFFs","text":"Index Created File size CDI Results 06-Aug-2024 16.51 MB FAPAR Anomaly Results 25-Jul-2024 2.98 MB SMA Results 25-Jul-2024 774.24 KB SPEI Results 25-Jul-2024 46.52 MB SPI Results 25-Jul-2024 46.79 MB VCI Results 25-Jul-2024 271.94 MB"},{"location":"examples/#sample-csvs","title":"Sample CSVs","text":"Index Created File size CDI Timeseries CSV 30-Aug-2024 1.22 MB FAPAR Anomaly Timeseries CSV 29-Aug-2024 297.79 KB SMA Timeseries CSV 29-Aug-2024 1.90 MB SPEI Timeseries CSV 29-Aug-2024 3.50 MB SPI Timeseries CSV 29-Aug-2024 3.48 MB VCI Timeseries CSV 30-Aug-2024 333.51 KB"},{"location":"theoretical_basis/","title":"Specifications","text":""},{"location":"theoretical_basis/#summary","title":"Summary","text":"<p>Drought is a common climate feature caused by prolonged low precipitation, poor rainfall timing, or increased water loss due to high temperatures. Monitoring droughts involves analysing various indicators and indices that reflect different parts of the hydrological cycle, such as precipitation, soil moisture, and water levels. These indicators show statistical anomalies compared to long-term climate data, indicating the severity of a drought.</p> <p>There are three main methods for monitoring droughts:</p> <ol> <li>Single indicator or index.</li> <li>Multiple indicators or indices.</li> <li>Composite or hybrid indicators.</li> </ol> <p>In the implementation of the ANIN project and through consultation with the South African partners, the following indices and indicators were developed for drought early warning, monitoring and forecasting for South Africa. </p> <p> </p> <p>The following sections describe the drought indices presented in this Handbook, as well as their key characteristics. For more information detailed information, please refer to the ATBD and product specification document of the ANIN project</p>"},{"location":"theoretical_basis/#standardised-precipitation-index-spi","title":"Standardised Precipitation Index (SPI)","text":"<p>SPI was developed to quantify precipitation deficits over various timescales, ranging from 1 to 36 months. This flexibility allows it to reflect short-term soil moisture conditions as well as long-term groundwater and reservoir storage levels.</p> <p></p>"},{"location":"theoretical_basis/#standardised-precipitation-evapotranspiration-index-spei","title":"Standardised Precipitation-Evapotranspiration Index (SPEI)","text":"<p>SPEI extends the capabilities of SPI by incorporating both precipitation and potential evapotranspiration (PET). This inclusion allows the SPEI to account for the effects of temperature on drought conditions. SPEI is able to reflect the impact of increased temperatures on water demand, which is crucial for understanding drought severity under changing climate conditions. The SPEI can be calculated over various timescales, from 1 to 48 months, allowing it to capture both short-term and long-term drought conditions.</p> <p></p>"},{"location":"theoretical_basis/#vegetation-condition-index-vci","title":"Vegetation Condition Index (VCI)","text":"<p>VCI is used to asses vegetation health by comparing current vegetation conditions to historical trends. It is particularly useful in monitoring drought conditions and their impact on vegetation. The VCI is calculated using the Normalized Difference Vegetation Index (NDVI), which normalises current NDVI values against historical minimum and maximum NDVI values for the same period, effectively separating weather-related impacts from ecological factors.</p> <p></p>"},{"location":"theoretical_basis/#soil-moisture-anomaly-sma","title":"Soil Moisture Anomaly (SMA)","text":"<p>SMA is used to assess deviations in soil moisture levels from the long-term average. It helps in understanding the extent of dryness or wetness in the soil, which is crucial for drought monitoring, agricultural planning, and water resource management. SMA is calculated by comparing current soil moisture levels to historical averages. Positive anomalies indicate wetter-than-average conditions, while negative anomalies signify drier-than-average conditions.</p> <p></p>"},{"location":"theoretical_basis/#combined-drought-indicator-cdi","title":"Combined Drought Indicator (CDI)","text":"<p>CDI is a comprehensive tool used to detect and monitor agricultural drought. It integrates multiple drought indicators to provide a detailed assessment of drought conditions, namely SPI, SMA and FAPAR Anomaly.</p> <p></p>"}]}